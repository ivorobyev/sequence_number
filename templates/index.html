<!DOCTYPE html>
<html>
  <head>
    <title>Sequence number</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
	<script src="{{ url_for('static', filename='js/excellentexport.min.js') }}"></script>
  </head>
  <body>
		<script>
				function calculate() {
					if ($.trim($('#name').val()) == ""){
						alert('Empty sequence')
						exit()
					}
					
					$.ajax({
						url: "/calc",
						data: $('form').serialize(),
						type: 'POST',
						success: function(response) {
							response = response.trim()
							seq_numbers = response.split(' ')
							
							var perrow = 3,
							tbl = "<table id = 'sequence_number'><tr><th>Number of nucleotide mutaions</th><th>Possible amino acid sequences</th><th>Integral number of amino acid sequences</th></tr><tr>";

							for (var i=0; i<seq_numbers.length; i++) {
								tbl += "<td>" + seq_numbers[i] + "</td>";
								var next = i+1;
								if (next%perrow==0 && next!=seq_numbers.length) {
									tbl += "</tr><tr>";
								}
							}
							tbl += "</tr></table>";

							$('#result').show()
							$('#len').html(tbl) 
						},
						error: function(request) {
							alert(request.responseJSON.messageqXHR)
						}
					});
				}
		</script>
	<div class ='container'>
    <div class="testbox">
      <form method="post" role="input_form">
        <div class="colums">
          <div class="item">
            <label for="name">Sequence</label>
            <input id="name" type="text" name="sequence"/>
		  </div>
		</div>
		<div class="item">
			<p>Choose codon table type</p>
			<select name = "codon_table">
			  <option value="1" selected>The Standard Code</option>
			  <option value="2">The Vertebrate Mitochondrial Code</option>
			  <option value="3">The Yeast Mitochondrial Code</option>
			  <option value="4">The Mold, Protozoan, and Coelenterate Mitochondrial Code and the Mycoplasma/Spiroplasma Code</option>
			  <option value="5" >The Invertebrate Mitochondrial Code</option>
			  <option value="6">The Ciliate, Dasycladacean and Hexamita Nuclear Code</option>
			  <option value="9">The Echinoderm Mitochondrial Code</option>
			  <option value="10">The Euplotid Nuclear Code</option>
			  <option value="11" >The Bacterial "Code"</option>
			  <option value="12">The Alternative Yeast Nuclear Code</option>
			  <option value="13">VegetThe Ascidian Mitochondrial Codearian</option>
			  <option value="14">The Flatworm Mitochondrial Code</option>
			  <option value="15" >Blepharisma Nuclear Code</option>
			</select>
		</div>
        <div class="question">
          <label>Mutate first codon?</label>
          <div class="question-answer">
            <div>
              <input type="radio" value="1" id="radio_1" name="mutate" checked = 'checked'/>
              <label for="radio_1" class="radio"><span>Yes</span></label>
            </div>
            <div>
              <input  type="radio" value="0" id="radio_2" name="mutate"/>
              <label for="radio_2" class="radio"><span>No</span></label>
            </div>
          </div>
		</div>

		<div class="question">
			<label>Maximum number of considered nucleotide substitutions</label>
			<div class="question-answer">
				<input type="number" name="max_mutations" step="1" min = "1" value = "1">
			</div>
		</div>

        <div class="btn-block">
		  <input type="button" value="Calculate" onclick="calculate()">
		</div>
	
	  </form>
	  <div id = 'result'>
		<div id = 'len'>
		</div>
		<br/>
		<a download="sequnce_number.csv" href="#" onclick="return ExcellentExport.csv(this, 'sequence_number');">Export to CSV</a>

	</div>
</div>
</div>
  </body>
</html>